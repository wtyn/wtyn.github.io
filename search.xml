<?xml version="1.0" encoding="utf-8"?>
<search> 
  
  
    
    <entry>
      <title>使用Ubuntu遇到问题的总结</title>
      <link href="/2020/02/19/ubuntu-shi-yong-zhong-de-wen-ti/"/>
      <url>/2020/02/19/ubuntu-shi-yong-zhong-de-wen-ti/</url>
      
        <content type="html"><![CDATA[<h1 id="shell无法使用source"><a href="#shell无法使用source" class="headerlink" title="shell无法使用source"></a>shell无法使用source</h1><h2 id="现象"><a href="#现象" class="headerlink" title="现象"></a>现象</h2><p>shell脚本中source aaa.sh时提示 source: not found</p><h2 id="原因"><a href="#原因" class="headerlink" title="原因"></a>原因</h2><pre class=" language-shell"><code class="language-shell"># 输入ls -l `which sh`# 提示/bin/sh -> dash# 这说明是用dash来进行解析的。</code></pre><h2 id="解决办法"><a href="#解决办法" class="headerlink" title="解决办法"></a>解决办法</h2><pre class=" language-shell"><code class="language-shell"># 执行sudo dpkg-reconfigure dash# 在界面中选择no# 再次输入ls -l `which sh`# 提示: /bin/sh -> bash# 说明修改成,source可以使用了~</code></pre><h2 id="查看当前命令"><a href="#查看当前命令" class="headerlink" title="查看当前命令"></a>查看当前命令</h2><pre class=" language-shell"><code class="language-shell">ls -l `which sh`</code></pre><h1 id="激活conda-虚拟环境"><a href="#激活conda-虚拟环境" class="headerlink" title="激活conda 虚拟环境"></a>激活conda 虚拟环境</h1><h2 id="背景"><a href="#背景" class="headerlink" title="背景"></a>背景</h2><p>既然在命令行中可以通过conda activate tf激活tf的虚拟环境,那能不能写个脚本实现呢?</p><p>执行会报以下的错误:</p><blockquote><p>CommandNotFoundError: Your shell has not been properly configured to use ‘conda activate’.<br>To initialize your shell, run</p><p>$ conda init <shell_name></shell_name></p><p>Currently supported shells are:</p><p>bash<br>fish<br>tcsh<br>xonsh<br>zsh<br>powershell<br>See ‘conda init –help’ for more information and options.</p></blockquote><h2 id="解决办法-1"><a href="#解决办法-1" class="headerlink" title="解决办法"></a>解决办法</h2><p>打开 ~/.bashrc文件,去找到下面文字</p><pre class=" language-shell"><code class="language-shell"># !! Contents within this block are managed by 'conda init' !!__conda_setup="$('/opt/Miniconda3/bin/conda' 'shell.bash' 'hook' 2> /dev/null)"if [ $? -eq 0 ]; then    eval "$__conda_setup"else    if [ -f "/opt/Miniconda3/etc/profile.d/conda.sh" ]; then        . "/opt/Miniconda3/etc/profile.d/conda.sh"    else        export PATH="/opt/Miniconda3/bin:$PATH"    fifiunset __conda_setup</code></pre><p>将上述文字,复制粘贴到脚本的开头,便可以实现</p><h2 id="NOTE"><a href="#NOTE" class="headerlink" title="NOTE"></a>NOTE</h2><p>无法对外部产生影响,但“脚本空间”内部是激活了tf环境的，所以在con.sh脚本里的“conda activate tf” 语句后面，你仍旧可以写一些依赖于tf环境的语句或者执行依赖tf环境的其他什么脚本（比如py）</p><h1 id="在shell脚本中cd命令无效"><a href="#在shell脚本中cd命令无效" class="headerlink" title="在shell脚本中cd命令无效"></a>在shell脚本中cd命令无效</h1><h2 id="现象-1"><a href="#现象-1" class="headerlink" title="现象"></a>现象</h2><p>编写了一个shell脚本run.sh, run.sh中包含cd等命令,运行该run.sh时却发现目录切换不了</p><h2 id="原因-1"><a href="#原因-1" class="headerlink" title="原因"></a>原因</h2><p>如果直接以<code>./run.sh</code>这种形式执行,终端会产生一个子shell,子shell去执行run.sh,在子shell中已经切换了目录,</p><p>`但是子shell一旦执行完,马上退出,子shell中的变量和操作全部都收回.回到终端根本就看不到这个过程的变化</p><h2 id="解决方法"><a href="#解决方法" class="headerlink" title="解决方法"></a>解决方法</h2><p>添加<code>source</code>或<code>.</code>方式运行脚本</p><pre class=" language-shell"><code class="language-shell">source ./run.sh</code></pre><p>或</p><pre class=" language-shell"><code class="language-shell">. ./run.sh</code></pre><h1 id="apt命令无法使用"><a href="#apt命令无法使用" class="headerlink" title="apt命令无法使用"></a>apt命令无法使用</h1><p>强制安装</p><pre class=" language-shell"><code class="language-shell">sudo dpkg -i --force-all apt*.deb</code></pre><script>        document.querySelectorAll('.github-emoji')          .forEach(el => {            if (!el.dataset.src) { return; }            const img = document.createElement('img');            img.style = 'display:none !important;';            img.src = el.dataset.src;            img.addEventListener('error', () => {              img.remove();              el.style.color = 'inherit';              el.style.backgroundImage = 'none';              el.style.background = 'none';            });            img.addEventListener('load', () => {              img.remove();            });            document.body.appendChild(img);          });      </script>]]></content>
      
      
      <categories>
          
          <category> 系统 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Ubuntu </tag>
            
            <tag> Problem </tag>
            
        </tags>
      
    </entry>
    
    
  
  
</search>
